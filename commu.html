<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surfly - 이용 후기</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header>
        <div class="title-banner">
            <div class="title-banner__logo">
                <h1><a href="index.html">Surfly</a></h1>
            </div>
            <nav class="title-banner__nav">
                <ul>
                    <li><a href="index.html">홈</a></li>
                    <li><a href="login.html">로그인</a></li>
                    <li><a href="commu.html">후기</a></li>
                    <li><a href="about.html">문의</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="commu-section">
        <div class="commu-container">
            <h2>이용 후기</h2>
            <p>여러분의 서핑 경험을 공유해주세요!</p>

            <form id="reviewForm" class="review-form">
                <div class="form-group">
                    <label for="name">이름</label>
                    <input type="text" id="name" name="name" placeholder="닉네임을 입력하세요" required>
                </div>
                <div class="form-group">
                    <label for="review">내용</label>
                    <textarea id="review" name="review" placeholder="서핑 후기를 자유롭게 남겨주세요." required></textarea>
                </div>
                <button type="submit" class="submit-btn">후기 등록</button>
            </form>

            <div class="review-list" id="reviewList">
                <h3>최신 후기</h3>
                <ul id="reviewsUl">
                    <!-- Javascript로 로드됨 -->
                </ul>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Surfly. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('reviewForm');
            const reviewsUl = document.getElementById('reviewsUl');

            // Load reviews
            loadReviews();

            // Submit Review
            form.addEventListener('submit', (e) => {
                e.preventDefault();

                const nameIn = document.getElementById('name');
                const reviewIn = document.getElementById('review');

                const newReview = {
                    id: Date.now(),
                    name: nameIn.value,
                    content: reviewIn.value,
                    date: new Date().toLocaleDateString('ko-KR')
                };

                const reviews = getReviews();
                reviews.unshift(newReview); // Add to top
                localStorage.setItem('surfly_reviews', JSON.stringify(reviews));

                // Clear & Reload
                nameIn.value = '';
                reviewIn.value = '';
                loadReviews();
                // alert('후기가 등록되었습니다!'); // UX: 토스트가 좋지만 간단히
            });

            function getReviews() {
                const stored = localStorage.getItem('surfly_reviews');
                return stored ? JSON.parse(stored) : [];
            }

            function loadReviews() {
                reviewsUl.innerHTML = '';
                const reviews = getReviews();

                if (reviews.length === 0) {
                    reviewsUl.innerHTML = '<li class="no-reviews">아직 등록된 후기가 없습니다. 첫 번째 후기를 남겨보세요!</li>';
                    return;
                }

                reviews.forEach(r => {
                    const li = document.createElement('li');
                    li.className = 'review-item';
                    li.innerHTML = `
                        <div class="review-header">
                            <span class="review-author">${r.name}</span>
                            <span class="review-date">${r.date}</span>
                        </div>
                        <div class="review-content">${r.content}</div>
                        <button class="delete-btn" onclick="deleteReview(${r.id})">&times;</button>
                    `;
                    reviewsUl.appendChild(li);
                });
            }

            // Global delete function
            window.deleteReview = function (id) {
                if (confirm('이 후기를 삭제하시겠습니까?')) {
                    let reviews = getReviews();
                    reviews = reviews.filter(r => r.id !== id);
                    localStorage.setItem('surfly_reviews', JSON.stringify(reviews));
                    loadReviews();
                }
            }
        });
    </script>
</body>

</html>